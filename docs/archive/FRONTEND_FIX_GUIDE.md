# å‰ç«¯ API è·¯å¾„ä¿®å¤æŒ‡å—

## ğŸ› é—®é¢˜æè¿°

å‰ç«¯æ‰€æœ‰ API è°ƒç”¨éƒ½æœ‰é‡å¤çš„ `/api` å‰ç¼€é—®é¢˜ï¼š

### é”™è¯¯çš„é…ç½®
```javascript
// api.js
baseURL: 'http://localhost:8000/api'

// stocks.js
apiClient.get('/api/stocks')  // âŒ å®é™…è¯·æ±‚: /api/api/stocks
```

### æ­£ç¡®çš„é…ç½®
```javascript
// api.js
baseURL: 'http://localhost:8000/api'

// stocks.js
apiClient.get('/stocks')  // âœ… å®é™…è¯·æ±‚: /api/stocks
```

---

## âœ… å·²ä¿®å¤çš„æ–‡ä»¶

### 1. `frontend/src/services/api.js`
- âœ… baseURL è®¾ç½®ä¸º `http://localhost:8000/api`
- âœ… è¶…æ—¶æ—¶é—´å¢åŠ åˆ° 30 ç§’
- âœ… æ”¹è¿›é”™è¯¯å¤„ç†

### 2. `frontend/src/services/stocks.js`
- âœ… `/api/stocks` â†’ `/stocks`
- âœ… `/api/stocks/${code}/kline` â†’ `/stocks/${code}/kline`
- âœ… `/api/stocks/${code}/info` â†’ `/stocks/${code}/info`

### 3. `frontend/src/services/strategies.js`
- âœ… `/api/strategies` â†’ `/strategies`
- âœ… `/api/strategies/${id}` â†’ `/strategies/${id}`

### 4. `frontend/src/services/indicators.js`
- âœ… `/api/indicators/types` â†’ `/indicators/types`
- âœ… `/api/indicators/calculate` â†’ `/indicators/calculate`

### 5. `frontend/src/services/backtests.js`
- âœ… è·¯å¾„å·²æ­£ç¡®ï¼ˆæ—  `/api` å‰ç¼€ï¼‰

### 6. `frontend/src/services/customIndicators.js`
- âœ… è·¯å¾„å·²æ­£ç¡®ï¼ˆæ—  `/api` å‰ç¼€ï¼‰

### 7. `frontend/src/components/StockSelector.vue`
- âœ… æ”¹è¿›å“åº”æ•°æ®å¤„ç†
- âœ… æ·»åŠ è°ƒè¯•æ—¥å¿—

---

## ğŸ”„ é‡å¯æ­¥éª¤

### 1. åœæ­¢å‰ç«¯æœåŠ¡
```bash
# åœ¨å‰ç«¯ç»ˆç«¯æŒ‰ Ctrl+C
```

### 2. æ¸…é™¤ç¼“å­˜
```bash
cd frontend
rm -rf node_modules/.vite
rm -rf dist
```

### 3. é‡æ–°å¯åŠ¨
```bash
npm run dev
```

### 4. å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨
- Windows/Linux: `Ctrl + Shift + R`
- Mac: `Cmd + Shift + R`

---

## ğŸ§ª éªŒè¯æ­¥éª¤

### 1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- æŒ‰ `F12` æˆ–å³é”® â†’ æ£€æŸ¥

### 2. åˆ‡æ¢åˆ° Network æ ‡ç­¾

### 3. è®¿é—®ç­–ç•¥é¡µé¢
- URL: http://localhost:5173/strategy

### 4. æ£€æŸ¥ç½‘ç»œè¯·æ±‚

**åº”è¯¥çœ‹åˆ°**:
```
âœ… GET http://localhost:8000/api/stocks
âœ… GET http://localhost:8000/api/strategies
âœ… GET http://localhost:8000/api/indicators/types
```

**ä¸åº”è¯¥çœ‹åˆ°**:
```
âŒ GET http://localhost:8000/api/api/stocks
âŒ GET http://localhost:8000/api/api/strategies
```

### 5. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—

**åº”è¯¥çœ‹åˆ°**:
```
Stock list response: {stocks: Array(4000+)}
Loaded stocks: 4000+
```

**ä¸åº”è¯¥çœ‹åˆ°**:
```
âŒ 404 Not Found
âŒ åŠ è½½è‚¡ç¥¨åˆ—è¡¨å¤±è´¥
```

---

## ğŸ“Š æµ‹è¯•æ¸…å•

å®Œæˆä»¥ä¸‹æµ‹è¯•ç¡®ä¿ä¿®å¤æˆåŠŸï¼š

### è‚¡ç¥¨é€‰æ‹©å™¨
- [ ] æ‰“å¼€ç­–ç•¥åˆ›å»ºå¯¹è¯æ¡†
- [ ] è‚¡ç¥¨é€‰æ‹©å™¨æ˜¾ç¤º"è¯·é€‰æ‹©è‚¡ç¥¨"
- [ ] ç‚¹å‡»ä¸‹æ‹‰æ¡†
- [ ] çœ‹åˆ°è‚¡ç¥¨åˆ—è¡¨ï¼ˆä¸æ˜¯"No data"ï¼‰
- [ ] å¯ä»¥æœç´¢è‚¡ç¥¨
- [ ] å¯ä»¥é€‰æ‹©è‚¡ç¥¨

### ç­–ç•¥ç®¡ç†
- [ ] å¯ä»¥æŸ¥çœ‹ç­–ç•¥åˆ—è¡¨
- [ ] å¯ä»¥åˆ›å»ºæ–°ç­–ç•¥
- [ ] å¯ä»¥æ·»åŠ æŠ€æœ¯æŒ‡æ ‡
- [ ] å¯ä»¥æ·»åŠ äº¤æ˜“æ¡ä»¶
- [ ] å¯ä»¥ä¿å­˜ç­–ç•¥

### å›æµ‹åŠŸèƒ½
- [ ] å¯ä»¥é€‰æ‹©ç­–ç•¥
- [ ] å¯ä»¥é€‰æ‹©è‚¡ç¥¨
- [ ] å¯ä»¥è¿è¡Œå›æµ‹
- [ ] å¯ä»¥æŸ¥çœ‹ç»“æœ

### è‡ªå®šä¹‰æŒ‡æ ‡
- [ ] å¯ä»¥æŸ¥çœ‹æŒ‡æ ‡åˆ—è¡¨
- [ ] å¯ä»¥åˆ›å»ºæ–°æŒ‡æ ‡
- [ ] å¯ä»¥éªŒè¯å…¬å¼
- [ ] å¯ä»¥æµ‹è¯•æŒ‡æ ‡

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹å®é™…è¯·æ±‚ URL

åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Network æ ‡ç­¾ä¸­ï¼š
1. æ‰¾åˆ°å¤±è´¥çš„è¯·æ±‚
2. æŸ¥çœ‹ Request URL
3. ç¡®è®¤æ˜¯å¦åŒ…å«é‡å¤çš„ `/api`

### 2. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

StockSelector ç»„ä»¶ç°åœ¨ä¼šè¾“å‡ºè°ƒè¯•æ—¥å¿—ï¼š
```javascript
Stock list response: {...}
Loaded stocks: 4000
```

å¦‚æœçœ‹åˆ° `Loaded stocks: 0`ï¼Œè¯´æ˜å“åº”æ ¼å¼ä¸å¯¹ã€‚

### 3. æ‰‹åŠ¨æµ‹è¯• API

```bash
# æµ‹è¯•è‚¡ç¥¨åˆ—è¡¨
curl http://localhost:8000/api/stocks

# åº”è¯¥è¿”å›
{
  "stocks": [
    {
      "code": "000001.SZ",
      "name": "å¹³å®‰é“¶è¡Œ",
      ...
    }
  ]
}
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: åˆ·æ–°åè¿˜æ˜¯æ˜¾ç¤º "No data"

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. æ£€æŸ¥ Network æ ‡ç­¾ä¸­çš„è¯·æ±‚ URL
4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl+Shift+Deleteï¼‰
5. é‡å¯å‰ç«¯æœåŠ¡

### Q2: æ§åˆ¶å°æ˜¾ç¤º 404 é”™è¯¯

**æ£€æŸ¥**:
- è¯·æ±‚ URL æ˜¯å¦æ­£ç¡®ï¼ˆåº”è¯¥æ˜¯ `/api/stocks` è€Œä¸æ˜¯ `/api/api/stocks`ï¼‰
- åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
- åç«¯è·¯ç”±æ˜¯å¦æ­£ç¡®æ³¨å†Œ

### Q3: æ§åˆ¶å°æ˜¾ç¤º CORS é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥åç«¯ CORS é…ç½®
2. ç¡®ä¿å‰ç«¯ URL åœ¨å…è®¸åˆ—è¡¨ä¸­
3. é‡å¯åç«¯æœåŠ¡

### Q4: è‚¡ç¥¨åˆ—è¡¨åŠ è½½å¾ˆæ…¢

**åŸå› **: é¦–æ¬¡åŠ è½½éœ€è¦ä» AkShare è·å–æ•°æ®

**è§£å†³æ–¹æ¡ˆ**:
- ç­‰å¾…åŠ è½½å®Œæˆï¼ˆå¯èƒ½éœ€è¦ 10-30 ç§’ï¼‰
- åç»­è®¿é—®ä¼šä½¿ç”¨ç¼“å­˜ï¼Œé€Ÿåº¦ä¼šå¿«å¾ˆå¤š

---

## ğŸ“ ä»£ç å¯¹æ¯”

### ä¿®å¤å‰
```javascript
// api.js
baseURL: 'http://localhost:8000'

// stocks.js
apiClient.get('/api/stocks')
// å®é™…è¯·æ±‚: http://localhost:8000/api/stocks âœ…
```

### ä¿®å¤å
```javascript
// api.js
baseURL: 'http://localhost:8000/api'

// stocks.js
apiClient.get('/stocks')
// å®é™…è¯·æ±‚: http://localhost:8000/api/stocks âœ…
```

ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ï¼Œä½†ç¬¬äºŒç§æ›´æ¸…æ™°ï¼Œå› ä¸ºï¼š
1. baseURL ç»Ÿä¸€ç®¡ç† API å‰ç¼€
2. æœåŠ¡æ–‡ä»¶ä¸­çš„è·¯å¾„æ›´ç®€æ´
3. æ›´å®¹æ˜“åˆ‡æ¢ä¸åŒçš„ API ç‰ˆæœ¬

---

## ğŸ¯ éªŒè¯æˆåŠŸçš„æ ‡å¿—

å½“ä¸€åˆ‡æ­£å¸¸æ—¶ï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

### ç­–ç•¥åˆ›å»ºé¡µé¢
```
æŠ€æœ¯æŒ‡æ ‡é…ç½®
é€‰æ‹©è‚¡ç¥¨å¹¶é…ç½®æŠ€æœ¯æŒ‡æ ‡å‚æ•°

é€‰æ‹©è‚¡ç¥¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯·é€‰æ‹©è‚¡ç¥¨                  â–¼  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“ ç‚¹å‡»å
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 000001.SZ - å¹³å®‰é“¶è¡Œ        SZ  â”‚
â”‚ 000002.SZ - ä¸‡ç§‘A           SZ  â”‚
â”‚ 600000.SH - æµ¦å‘é“¶è¡Œ        SH  â”‚
â”‚ 600036.SH - æ‹›å•†é“¶è¡Œ        SH  â”‚
â”‚ ...                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµè§ˆå™¨æ§åˆ¶å°
```
Stock list response: {stocks: Array(4000)}
Loaded stocks: 4000
```

### Network æ ‡ç­¾
```
âœ… GET /api/stocks - 200 OK
âœ… GET /api/strategies - 200 OK
âœ… GET /api/indicators/types - 200 OK
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

ä¿®å¤å®Œæˆåï¼Œä½ å¯ä»¥ï¼š

1. **åˆ›å»ºç­–ç•¥** - é€‰æ‹©è‚¡ç¥¨å’ŒæŒ‡æ ‡
2. **è¿è¡Œå›æµ‹** - æµ‹è¯•ç­–ç•¥æ€§èƒ½
3. **æŸ¥çœ‹ç»“æœ** - åˆ†æå¤æ™®æ¯”ç‡ç­‰æŒ‡æ ‡
4. **åˆ›å»ºè‡ªå®šä¹‰æŒ‡æ ‡** - ä½¿ç”¨å…¬å¼å¼•æ“

---

ç°åœ¨é‡å¯å‰ç«¯æœåŠ¡ï¼Œåº”è¯¥å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼ğŸ‰
