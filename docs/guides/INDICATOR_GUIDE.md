# 技术指标使用指南

## 回测性能指标

### 夏普比率 (Sharpe Ratio)
**定义**: 衡量投资组合风险调整后收益的指标

**计算公式**: (投资回报率 - 无风险利率) / 收益标准差

**评价标准**:
- \> 3: 卓越 - 非常优秀的风险收益比
- \> 2: 优秀 - 良好的风险收益比
- \> 1: 良好 - 可接受的风险收益比
- \> 0: 一般 - 收益高于无风险利率
- ≤ 0: 较差 - 收益低于无风险利率

**意义**: 夏普比率越高，说明每承担一单位风险获得的超额回报越多。例如夏普比率为1.5，表示每承担1单位风险获得1.5单位的超额收益。

### 年化收益率 (Annual Return)
**定义**: 将回测期间的总收益率按年计算

**用途**: 便于与其他投资产品比较，如银行理财、基金等

**示例**: 年化收益率20%表示平均每年获得20%的收益

### 最大回撤 (Max Drawdown)
**定义**: 从峰值到谷底的最大跌幅

**意义**: 衡量最坏情况下可能遭受的损失

**示例**: 最大回撤-15%表示在回测期间，资金最多从高点下跌了15%

**风险控制**: 
- 最大回撤 < 10%: 风险较低
- 最大回撤 10-20%: 风险中等
- 最大回撤 > 20%: 风险较高

### 胜率 (Win Rate)
**定义**: 盈利交易次数 / 总交易次数

**示例**: 胜率60%表示100次交易中有60次是盈利的

**注意**: 胜率高不一定收益高，还要看盈亏比

---

## 技术指标详解

### 趋势类指标

#### 1. MA - 移动平均线 (Moving Average)
**说明**: 计算一定周期内的平均价格，用于判断价格趋势方向

**参数**:
- periods: 周期数组，如[5,10,20]表示5日、10日、20日均线

**使用方法**:
- 金叉: 短期MA上穿长期MA，买入信号
- 死叉: 短期MA下穿长期MA，卖出信号
- 价格在MA之上: 多头趋势
- 价格在MA之下: 空头趋势

**示例条件**:
```
买入: MA5 > MA10
卖出: MA5 < MA10
```

#### 2. EMA - 指数移动平均线 (Exponential Moving Average)
**说明**: 对近期价格赋予更高权重的移动平均线，反应更灵敏

**参数**:
- periods: 周期数组，常用[12,26,50]

**优势**: 比MA更快地反应价格变化，适合短线交易

**示例条件**:
```
买入: EMA12 > EMA26
卖出: EMA12 < EMA26
```

#### 3. MACD - 指数平滑异同移动平均线
**说明**: 通过快慢两条EMA的差值来判断趋势强度和转折点

**参数**:
- fast_period: 快线周期，默认12
- slow_period: 慢线周期，默认26
- signal_period: 信号线周期，默认9

**输出**:
- DIF: 快线与慢线的差值
- DEA: DIF的移动平均
- MACD: (DIF - DEA) × 2，柱状图

**使用方法**:
- DIF上穿DEA: 金叉，买入信号
- DIF下穿DEA: 死叉，卖出信号
- MACD柱状图由负转正: 买入信号
- MACD柱状图由正转负: 卖出信号

**示例条件**:
```
买入: DIF > DEA 且 MACD > 0
卖出: DIF < DEA 且 MACD < 0
```

#### 4. BOLL - 布林带 (Bollinger Bands)
**说明**: 由中轨（MA）和上下轨（标准差）组成，用于判断价格波动范围

**参数**:
- period: 移动平均周期，默认20
- std_dev: 标准差倍数，默认2.0

**输出**:
- upper: 上轨 = 中轨 + 2倍标准差
- middle: 中轨 = 20日MA
- lower: 下轨 = 中轨 - 2倍标准差

**使用方法**:
- 价格触及下轨: 超卖，可能反弹（买入）
- 价格触及上轨: 超买，可能回调（卖出）
- 布林带收窄: 波动率降低，可能突破
- 布林带扩张: 波动率增加，趋势明显

**示例条件**:
```
买入: close < BOLL_lower
卖出: close > BOLL_upper
```

#### 5. DMI - 趋向指标 (Directional Movement Index)
**说明**: 通过+DI和-DI判断趋势方向，ADX判断趋势强度

**参数**:
- period: 计算周期，默认14

**输出**:
- +DI: 上升动向指标
- -DI: 下降动向指标
- ADX: 平均趋向指标（趋势强度）

**使用方法**:
- +DI上穿-DI: 买入信号
- -DI上穿+DI: 卖出信号
- ADX > 25: 趋势明显
- ADX < 20: 无明显趋势

**示例条件**:
```
买入: ADX > 25 且 +DI > -DI
卖出: ADX > 25 且 -DI > +DI
```

---

### 动量类指标

#### 6. RSI - 相对强弱指标 (Relative Strength Index)
**说明**: 衡量价格涨跌速度的动量指标，范围0-100

**参数**:
- period: 计算周期，默认14

**使用方法**:
- RSI < 30: 超卖区域，买入信号
- RSI > 70: 超买区域，卖出信号
- RSI = 50: 多空平衡
- RSI背离: 价格创新高但RSI未创新高，可能反转

**示例条件**:
```
买入: RSI < 30
卖出: RSI > 70
```

#### 7. KDJ - 随机指标 (Stochastic Oscillator)
**说明**: 通过K、D、J三条线判断超买超卖状态，范围0-100

**参数**:
- n: RSV周期，默认9
- m1: K值平滑周期，默认3
- m2: D值平滑周期，默认3

**使用方法**:
- K线上穿D线: 金叉，买入信号
- K线下穿D线: 死叉，卖出信号
- J < 20: 超卖区域
- J > 80: 超买区域

**示例条件**:
```
买入: K > D 且 J < 20
卖出: K < D 且 J > 80
```

#### 8. CCI - 顺势指标 (Commodity Channel Index)
**说明**: 衡量价格偏离统计平均值的程度，无固定范围

**参数**:
- period: 计算周期，默认14

**使用方法**:
- CCI > 100: 超买区域
- CCI < -100: 超卖区域
- CCI在±100之间: 正常波动

**示例条件**:
```
买入: CCI < -100
卖出: CCI > 100
```

#### 9. WR - 威廉指标 (Williams %R)
**说明**: 衡量超买超卖的动量指标，范围0到-100

**参数**:
- period: 计算周期，默认14

**使用方法**:
- WR < -80: 超卖区域，买入信号
- WR > -20: 超买区域，卖出信号

**示例条件**:
```
买入: WR < -80
卖出: WR > -20
```

---

### 波动类指标

#### 10. ATR - 平均真实波幅 (Average True Range)
**说明**: 衡量价格波动幅度的指标，用于设置止损位

**参数**:
- period: 计算周期，默认14

**使用方法**:
- ATR值越大: 波动越剧烈
- 止损位设置: 入场价 ± 2倍ATR
- 仓位管理: ATR大时减少仓位

**示例**:
```
如果ATR = 2元，买入价10元
止损位 = 10 - 2×2 = 6元
```

---

### 成交量类指标

#### 11. OBV - 能量潮指标 (On Balance Volume)
**说明**: 通过累计成交量变化判断资金流向

**使用方法**:
- OBV上升: 资金流入，看涨
- OBV下降: 资金流出，看跌
- 价格上涨但OBV下降: 背离，可能反转

**示例条件**:
```
买入: OBV持续上升 且 价格上涨
卖出: OBV持续下降 且 价格下跌
```

#### 12. VWAP - 成交量加权平均价 (Volume Weighted Average Price)
**说明**: 考虑成交量的平均价格，反映真实的市场成本

**使用方法**:
- 价格 > VWAP: 强势，多头占优
- 价格 < VWAP: 弱势，空头占优
- 价格回归VWAP: 均值回归机会

**示例条件**:
```
买入: close > VWAP
卖出: close < VWAP
```

---

## 指标组合策略示例

### 1. 趋势跟踪策略
```
指标: MA5, MA10, MA20
买入条件:
  - MA5 > MA10
  - MA10 > MA20
  - close > MA5
卖出条件:
  - MA5 < MA10
```

### 2. 超买超卖策略
```
指标: RSI(14), KDJ(9,3,3)
买入条件:
  - RSI < 30
  - J < 20
卖出条件:
  - RSI > 70
  - J > 80
```

### 3. 趋势+动量策略
```
指标: MACD(12,26,9), RSI(14)
买入条件:
  - DIF > DEA
  - MACD > 0
  - RSI > 50
卖出条件:
  - DIF < DEA
  - RSI < 50
```

### 4. 布林带突破策略
```
指标: BOLL(20,2), ATR(14)
买入条件:
  - close < BOLL_lower
  - ATR < 历史平均值（波动不大）
卖出条件:
  - close > BOLL_upper
```

---

## 使用建议

1. **不要过度依赖单一指标**: 结合多个指标可以提高准确性
2. **考虑市场环境**: 趋势市场和震荡市场适用的指标不同
3. **参数优化**: 不同股票和周期可能需要不同的参数
4. **风险控制**: 设置止损位，控制单次交易风险
5. **回测验证**: 在实盘前充分回测策略的有效性
6. **持续优化**: 根据回测结果不断调整和优化策略

---

## 常见问题

**Q: 为什么回测没有交易？**
A: 可能是策略条件过于严格，在整个回测期间都没有被触发。建议放宽条件或检查指标参数。

**Q: 夏普比率为0是什么意思？**
A: 表示策略收益等于无风险利率，或者没有产生任何交易。

**Q: 如何选择合适的指标？**
A: 
- 趋势市场: 使用MA、EMA、MACD等趋势指标
- 震荡市场: 使用RSI、KDJ、BOLL等超买超卖指标
- 结合使用: 趋势指标+动量指标+成交量指标

**Q: 回测效果好，实盘效果差？**
A: 可能存在过度拟合。建议：
- 使用更长的回测周期
- 在不同市场环境下测试
- 考虑交易成本和滑点
- 避免使用过多指标
