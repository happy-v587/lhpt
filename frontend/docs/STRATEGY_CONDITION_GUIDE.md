# 策略交易条件填写指南

## 📋 界面说明

更新后的策略创建界面现在包含：

### 交易条件区域

每个条件包含 **5 个部分**：

```
[动作选择] 当 [指标名称] [操作符] [比较值] [删除按钮]
```

1. **动作选择** - 下拉框，选择"买入"或"卖出"
2. **指标名称** - 输入框，填写指标名称（如 MA5）
3. **操作符** - 下拉框，选择比较运算符（>, <, >=, <=, ==）
4. **比较值** - 输入框，填写数字或另一个指标名称
5. **删除按钮** - 删除该条件

### 添加条件按钮

- **添加买入条件** - 绿色按钮，添加一个买入条件
- **添加卖出条件** - 红色按钮，添加一个卖出条件

### 条件预览区域

实时显示已配置的买入和卖出条件，方便检查。

---

## 🎯 填写示例

### 示例 1: 简单 MA 交叉策略

**步骤 1: 添加技术指标**
```
MA - {"periods": [5, 20]}
```

**步骤 2: 添加买入条件**
点击"添加买入条件"按钮，填写：
```
动作: 买入
指标: MA5
操作符: >
值: MA20
```

**步骤 3: 添加卖出条件**
点击"添加卖出条件"按钮，填写：
```
动作: 卖出
指标: MA5
操作符: <
值: MA20
```

**预览效果**:
```
📈 买入条件 (1)
  MA5 > MA20
  (所有条件需同时满足)

📉 卖出条件 (1)
  MA5 < MA20
  (所有条件需同时满足)
```

---

### 示例 2: MACD + RSI 组合策略

**步骤 1: 添加技术指标**
```
1. MACD - {"fast_period": 12, "slow_period": 26, "signal_period": 9}
2. RSI - {"period": 14}
```

**步骤 2: 添加买入条件**

条件 1:
```
动作: 买入
指标: DIF
操作符: >
值: DEA
```

条件 2:
```
动作: 买入
指标: RSI
操作符: <
值: 50
```

**步骤 3: 添加卖出条件**

条件 1:
```
动作: 卖出
指标: DIF
操作符: <
值: DEA
```

条件 2:
```
动作: 卖出
指标: RSI
操作符: >
值: 50
```

**预览效果**:
```
📈 买入条件 (2)
  DIF > DEA
  RSI < 50
  (所有条件需同时满足)

📉 卖出条件 (2)
  DIF < DEA
  RSI > 50
  (所有条件需同时满足)
```

---

### 示例 3: RSI 超买超卖策略

**步骤 1: 添加技术指标**
```
RSI - {"period": 14}
```

**步骤 2: 添加买入条件**
```
动作: 买入
指标: RSI
操作符: <
值: 30
```

**步骤 3: 添加卖出条件**
```
动作: 卖出
指标: RSI
操作符: >
值: 70
```

**预览效果**:
```
📈 买入条件 (1)
  RSI < 30
  (所有条件需同时满足)

📉 卖出条件 (1)
  RSI > 70
  (所有条件需同时满足)
```

---

## 📝 填写规则

### 1. 动作选择

| 选项 | 说明 | 图标 |
|------|------|------|
| 买入 | 满足条件时买入股票 | 📈 绿色 |
| 卖出 | 满足条件时卖出股票 | 📉 红色 |

### 2. 指标名称规则

根据添加的技术指标，可用的指标名称：

**MA 指标**:
- 配置: `{"periods": [5, 10, 20, 60]}`
- 可用名称: `MA5`, `MA10`, `MA20`, `MA60`

**EMA 指标**:
- 配置: `{"periods": [12, 26, 50]}`
- 可用名称: `EMA12`, `EMA26`, `EMA50`

**MACD 指标**:
- 固定名称: `DIF`, `DEA`, `MACD`

**RSI 指标**:
- 固定名称: `RSI`

**BOLL 指标**:
- 固定名称: `upper`, `middle`, `lower`

**KDJ 指标**:
- 固定名称: `K`, `D`, `J`

**其他指标**:
- CCI: `CCI`
- ATR: `ATR`
- OBV: `OBV`
- WR: `WR`
- DMI: `PDI`, `MDI`, `ADX`
- VWAP: `VWAP`

### 3. 操作符说明

| 操作符 | 含义 | 使用场景 |
|--------|------|----------|
| `>` | 大于 | 指标上穿某个值 |
| `<` | 小于 | 指标下穿某个值 |
| `>=` | 大于等于 | 指标达到或超过阈值 |
| `<=` | 小于等于 | 指标达到或低于阈值 |
| `==` | 等于 | 指标等于特定值 |

### 4. 比较值填写

**数字值**:
- 直接输入数字，如: `30`, `70`, `0`, `2.5`
- 用于与固定阈值比较

**指标名称**:
- 输入另一个指标的名称，如: `MA20`, `DEA`, `middle`
- 用于指标之间的比较

---

## ⚠️ 重要提示

### 1. 必须同时有买入和卖出条件

系统会检查：
- ✅ 至少有 1 个买入条件
- ✅ 至少有 1 个卖出条件

如果缺少任一类型，会提示错误。

### 2. 多个条件的逻辑

**同一动作的多个条件是 AND 关系**:
- 买入条件: 条件1 **AND** 条件2 **AND** 条件3
- 卖出条件: 条件1 **AND** 条件2 **AND** 条件3

**示例**:
```
买入条件:
  MA5 > MA20
  RSI < 50

含义: 当 MA5 大于 MA20 并且 RSI 小于 50 时，才会买入
```

### 3. 指标名称必须准确

- ✅ 正确: `MA5`, `DIF`, `RSI`
- ❌ 错误: `ma5`, `Ma5`, `MA_5`, `dif`

大小写敏感，必须与指标定义完全一致。

### 4. 指标必须先添加

在"技术指标"区域添加的指标，才能在"交易条件"中使用。

---

## 🎨 界面特性

### 1. 颜色区分

- **买入条件**: 绿色背景，绿色标签
- **卖出条件**: 红色背景，红色标签

### 2. 实时预览

配置条件时，下方会实时显示：
- 买入条件列表
- 卖出条件列表
- 条件数量统计

### 3. 验证提示

- 缺少买入条件时，会提示"请至少添加一个买入条件"
- 缺少卖出条件时，会提示"请至少添加一个卖出条件"
- 指标名称错误时，回测会失败并提示

---

## 📊 完整配置流程

### 第一步: 填写基本信息
```
策略名称: MA交叉策略
策略描述: 5日均线上穿20日均线买入，下穿卖出
```

### 第二步: 添加技术指标
```
点击"添加指标"
选择: MA
配置: periods = [5, 20]
保存
```

### 第三步: 添加买入条件
```
点击"添加买入条件"
动作: 买入 (自动选中)
指标: MA5
操作符: >
值: MA20
```

### 第四步: 添加卖出条件
```
点击"添加卖出条件"
动作: 卖出 (自动选中)
指标: MA5
操作符: <
值: MA20
```

### 第五步: 检查预览
```
📈 买入条件 (1)
  MA5 > MA20

📉 卖出条件 (1)
  MA5 < MA20
```

### 第六步: 创建策略
```
点击"创建"按钮
等待成功提示
```

---

## 🔍 查看已创建的策略

在策略列表中点击"查看"按钮，可以看到：

### 策略详情
- 策略名称
- 描述
- 创建时间

### 技术指标
- 显示所有添加的指标及参数

### 交易条件
分为两个区域显示：

**📈 买入条件**
- 绿色背景
- 显示所有买入条件
- 如果没有，显示"暂无买入条件"

**📉 卖出条件**
- 红色背景
- 显示所有卖出条件
- 如果没有，显示"暂无卖出条件"

---

## 💡 常见策略模板

### 1. 双均线策略
```
指标: MA - [5, 20]
买入: MA5 > MA20
卖出: MA5 < MA20
```

### 2. MACD 金叉策略
```
指标: MACD - {fast: 12, slow: 26, signal: 9}
买入: DIF > DEA
卖出: DIF < DEA
```

### 3. RSI 超买超卖
```
指标: RSI - {period: 14}
买入: RSI < 30
卖出: RSI > 70
```

### 4. 布林带突破
```
指标: BOLL - {period: 20, std_dev: 2}
买入: close < lower
卖出: close > upper
```

### 5. 多指标组合
```
指标: 
  - MA - [5, 20]
  - RSI - {period: 14}
  
买入条件:
  - MA5 > MA20
  - RSI < 50
  
卖出条件:
  - MA5 < MA20
  - RSI > 50
```

---

## ❓ 常见问题

### Q1: 为什么我的条件没有显示买入/卖出标签？

A: 请确保：
1. 前端代码已更新
2. 浏览器已刷新（Ctrl+F5 强制刷新）
3. 在添加条件时选择了"动作"

### Q2: 可以只有买入条件，没有卖出条件吗？

A: 不可以。系统要求至少有一个买入条件和一个卖出条件，否则无法创建策略。

### Q3: 多个买入条件是什么关系？

A: 是 AND 关系，所有买入条件都必须同时满足才会触发买入。

### Q4: 如何实现"或"的逻辑？

A: 目前不支持 OR 逻辑。如需实现，可以创建多个策略分别测试。

### Q5: 指标名称大小写重要吗？

A: 非常重要！必须严格按照指标定义的名称填写，如 `MA5` 不能写成 `ma5`。

---

## 🎉 总结

更新后的界面特点：

✅ **清晰的买入/卖出区分** - 通过颜色和标签明确标识  
✅ **实时预览** - 配置时即可看到效果  
✅ **智能验证** - 自动检查条件完整性  
✅ **友好提示** - 详细的错误提示和使用说明  
✅ **直观展示** - 查看策略时分区显示买入和卖出条件  

现在创建策略更加直观和便捷了！🚀
